{{#sticky-element top=navigationState.globalBarHeight}}
  <div class="row content-row header-row hidden-xs has-border">
    <h1 class="with-menu">
      <span class="one-label">
        {{tt this "members"}}
      </span>
      <div class="btn-toolbar with-place-for-dots">
        {{#bs-button size="sm" onClick=(action "batchEdit") disabled=(not batchEditAvailable)}}
          {{tt this "multiedit"}}
        {{/bs-button}}
      </div>
      {{actions-toolbar isMinimized=true actionsArray=headerActions}}
    </h1>
  </div>
{{/sticky-element}}
{{#loading-container
  isLoading=(or groupList.isPending userList.isPending)
  errorReason=(or groupList.reason userList.reason)}}
  <div class="row">
    {{#collection-permissions
      proxyList=proxyGroupRecordList
      subjectType="group"
      recordsSelected=(action "recordsSelected" "group")
      listHeader=(tt this "groups")
      itemIcon="groups"
      groupedPrivilegesFlags=groupedPrivilegesFlags
      privilegeGroupsTranslationsPath=privilegeGroupsTranslationsPath
      privilegesTranslationsPath=privilegesTranslationsPath
      save=(action "saveOne")
      collectionActions=groupListActions
      itemActions=groupActions as |list|}}
      {{#list.item as |listItem|}}
        {{#listItem.header
          class="text-center"
          disableToggleIcon=true
          isCollapsible=false
          hasCheckbox=false
          truncate=false}}
          <span class="one-label">
            {{tt this "noGroupsStart"}}
            <a {{action (mut inviteTokenModalType) "group"}}>{{tt this "noGroupsInvite"}}</a>
            {{tt this "noGroupsEnd"}}
          </span>
        {{/listItem.header}}
      {{/list.item}}
    {{/collection-permissions}}
  </div>
  <div class="row">
    {{#collection-permissions
      proxyList=proxyUserRecordList
      subjectType="user"
      recordsSelected=(action "recordsSelected" "user")
      listHeader=(tt this "users")
      itemIcon="user"
      groupedPrivilegesFlags=groupedPrivilegesFlags
      privilegeGroupsTranslationsPath=privilegeGroupsTranslationsPath
      privilegesTranslationsPath=privilegesTranslationsPath
      save=(action "saveOne")
      collectionActions=userListActions
      itemActions=userActions as |list|}}
      {{#list.item as |listItem|}}
        {{#listItem.header
          class="text-center"
          disableToggleIcon=true
          isCollapsible=false
          hasCheckbox=false
          truncate=false}}
          <span class="one-label">
            {{tt this "noUsersStart"}}
            <a {{action (mut inviteTokenModalType) "user"}}>{{tt this "noUsersInvite"}}</a>
            {{tt this "noUsersEnd"}}
          </span>
        {{/listItem.header}}
      {{/list.item}}
    {{/collection-permissions}}
  </div>
{{/loading-container}}
{{privileges-editor-modal
  privilegesGroups=groupedPrivilegesFlags
  privilegeGroupsTranslationsPath=privilegeGroupsTranslationsPath
  privilegesTranslationsPath=privilegesTranslationsPath
  recordProxy=batchEditModalModel
  save=(action "saveBatch")
  close=(action "batchEditClose")
  opened=batchEditActive
  processing=batchEditModalModel.isSaving
  treeRootText=(tt this "batchEditModalSelectedItems")}}
{{join-as-user-modal
  opened=joinAsUserModalVisible
  close=(action (mut joinAsUserModalVisible) false)
  proceed=(action "join")
  processing=isJoiningAsUser
  modelType=record.entityType
  model=record}}
{{group-create-relative-modal
  opened=createChildGroupModalVisible
  close=(action (mut createChildGroupModalVisible) false)
  proceed=(action "createChildGroup")
  processing=isCreatingChildGroup
  relatedRecord=record
  relation=(if (eq record.entityType "group") "child" "member")}}
{{group-add-your-group-modal
  opened=addYourGroupModalVisible
  close=(action (mut addYourGroupModalVisible) false)
  proceed=(action "addYourGroup")
  processing=isAddingYourGroup
  relatedRecord=record
  relation=(if (eq record.entityType "group") "child" "member")}}
{{invite-using-token-modal
  opened=inviteTokenModalType
  close=(action (mut inviteTokenModalType) null)
  tokenType=inviteTokenModalType
  record=record}}
{{remove-relation-modal
  opened=(and memberToRemove (not memberToRemove.isDeleted))
  close=(action (mut memberToRemove) null)
  proceed=(action "removeMember")
  processing=isRemovingMember
  parent=record
  child=memberToRemove}}
{{yield}}
