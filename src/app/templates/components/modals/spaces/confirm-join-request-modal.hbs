{{#global-modal
  classNames="confirm-join-request-modal"
  modalId=modalId
  allowClose=false
  size="lg"
  as |modal|
}}
  {{#modal.header}}
    <h1>
      {{#if (not isMarketplaceEnabled)}}
        {{one-icon icon="sign-warning-rounded"}}
        <span class="one-label">{{tt this "header.marketplaceDisabled"}}</span>
      {{else if requesterInfoProxy.isFulfilled}}
        {{one-icon icon="sign-info-rounded"}}
        <span class="one-label">{{tt this "header.valid"}}</span>
      {{else if requesterInfoProxy.isPending}}
        {{one-icon icon="sign-info-rounded"}}
        <span class="one-label">{{tt this "header.loading"}}</span>
      {{else}}
        {{one-icon icon="sign-error-rounded"}}
        <span class="one-label">{{tt this "header.failed"}}</span>
      {{/if}}
    </h1>
  {{/modal.header}}

  {{#modal.body}}
    {{#if isMarketplaceEnabled}}
      {{#promise-proxy-container
        tagName="div"
        class=(if bodyRequiredDataProxy.isPending "loadable-row")
        proxy=bodyRequiredDataProxy
      }}
        <p>
          {{tt this "body.valid.accessTo"}}
          <strong class="space-name">{{name-conflict item=spaceProxy.content}}</strong>
          {{tt this "body.valid.spaceRequestedBy"}}
          <strong class="user-full-name">{{requesterInfo.fullName}}</strong>
          {{#if requesterInfo.contactEmail}}
            {{!-- do not break all lines to avoid spaces --}}
            (<a
              class="azure user-email"
              href={{concat "mailto:" requesterInfo.contactEmail}}
            >{{requesterInfo.contactEmail}}</a>)
          {{/if}}
          {{tt this "body.valid.usingMarketplace"}}
        </p>
        <p>{{tt this "body.valid.info"}}</p>
        {{join-image
          class="user-join-space-image hidden-xs"
          joiningModelName="user"
          joiningRecord=joiningUserLikeRecord
          inviteTargetModelName="space"
          inviteTargetId=spaceId
          inviteTargetName=spaceName
        }}
        <p>{{tt this "body.valid.question"}}</p>
      {{/promise-proxy-container}}
    {{else}}
      <p>{{tt this "body.marketplaceDisabled"}}</p>
    {{/if}}
  {{/modal.body}}

  {{#if requesterInfoProxy.isSettled}}
    {{#modal.footer class="btn-toolbar"}}
      {{#if isProceedButtonVisible}}
        {{#one-button
          type="warning"
          class="reject-btn"
          disabled=(not isProceedAvailable)
          onClick=(action "reject")
        }}
          {{tt this "rejectBtn"}}
        {{/one-button}}
        {{#one-button
          type="primary"
          class="grant-btn"
          disabled=(not isProceedAvailable)
          onClick=(action "grant")
        }}
          {{tt this "grantBtn"}}
        {{/one-button}}
      {{else}}
        {{#one-button
          type="default"
          class="close-btn"
          onClick=modal.close
        }}
          {{tt this "close"}}
        {{/one-button}}
      {{/if}}
    {{/modal.footer}}
  {{/if}}

{{/global-modal}}
